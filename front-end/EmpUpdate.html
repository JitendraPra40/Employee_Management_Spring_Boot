<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Update Employee</title>
</head>
<body>

<h2>Search Employee</h2>

<label>Enter Employee ID:</label>
<input type="number" id="searchId">
<button onclick="fetchEmployee()">Get Employee</button>

<hr>

<h2>Update Employee</h2>

<form id="updateForm">
    <input type="hidden" id="id">

    <label>First Name:</label>
    <input type="text" id="firstName"><br><br>

    <label>Last Name:</label>
    <input type="text" id="lastName"><br><br>

    <label>Email:</label>
    <input type="email" id="email"><br><br>

    <label>Phone:</label>
    <input type="text" id="phone"><br><br>

    <label>Gender:</label>
    <select id="gender">
        <option value="">--Select--</option>
        <option value="Male">Male</option>
        <option value="Female">Female</option>
        <option value="Other">Other</option>
    </select><br><br>

    <label>Date of Birth:</label>
    <input type="date" id="dateOfBirth"><br><br>

    <label>Date of Joining:</label>
    <input type="date" id="dateOfJoining"><br><br>

    <label>Designation:</label>
    <input type="text" id="designation"><br><br>

    <label>Status:</label>
    <select id="status">
        <option value="">--Select--</option>
        <option value="ACTIVE">ACTIVE</option>
        <option value="INACTIVE">INACTIVE</option>
    </select><br><br>

    <label>Department ID:</label>
    <input type="number" id="departmentId"><br><br>

    <button type="button" onclick="updateEmployee()">Update Employee</button>
</form>

<hr>

<pre id="output"></pre>

<script>
    function fetchEmployee() {
        const id = document.getElementById("searchId").value;

        fetch(`http://localhost:8080/api/employees/empid?id=${id}`)
            .then(res => res.json())
            .then(response => {
                const emp = response.data;

                document.getElementById("id").value = emp.id;
                document.getElementById("firstName").value = emp.firstName;
                document.getElementById("lastName").value = emp.lastName;
                document.getElementById("email").value = emp.email;
                document.getElementById("phone").value = emp.phone;
                document.getElementById("gender").value = emp.gender;
                document.getElementById("dateOfBirth").value = emp.dateOfBirth;
                document.getElementById("dateOfJoining").value = emp.dateOfJoining;
                document.getElementById("designation").value = emp.designation;
                document.getElementById("status").value = emp.status;
                document.getElementById("departmentId").value = emp.departmentId;

                document.getElementById("output").innerText =
                    "Employee loaded successfully. You may now edit and update.";
            })
            .catch(err => {
                document.getElementById("output").innerText =
                    "Error fetching employee: " + err;
            });
    }

    function updateEmployee() {
        const id = document.getElementById("id").value;

        const updatedEmployee = {
            id: id,
            firstName: document.getElementById("firstName").value,
            lastName: document.getElementById("lastName").value,
            email: document.getElementById("email").value,
            phone: document.getElementById("phone").value,
            gender: document.getElementById("gender").value,
            dateOfBirth: document.getElementById("dateOfBirth").value,
            dateOfJoining: document.getElementById("dateOfJoining").value,
            designation: document.getElementById("designation").value,
            status: document.getElementById("status").value,
            departmentId: document.getElementById("departmentId").value
        };

        fetch(`http://localhost:8080/api/employees/update?id=${id}`, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(updatedEmployee)
        })
            .then(res => res.json())
            .then(data => {
                document.getElementById("output").innerText =
                    JSON.stringify(data, null, 2);
            })
            .catch(err => {
                document.getElementById("output").innerText =
                    "Error updating employee: " + err;
            });
    }
</script>

</body>
</html>
